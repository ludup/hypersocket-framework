<div id="principalPasswordPolicy">
<div class="panel panel-default" style="padding-bottom: 10px;">
	<div class="panel-heading">
		<h2><i class="fa fa-key"></i><span class="break" localize="myPassword.title">Password Information</span></h2>
	</div>
	<div class="panel-body">
	    <div id="infoTab" class="col-xs-12">   	
    	</div>
    	<div id="changeTab" class="col-xs-12"> 
    	    <a href="#menu=changePassword" class="btn btn-primary" localize="changePassword.title"></a>  	
    	</div>
    	<div id="policyTab" class="col-xs-12">   	
	    </div>
	</div>
</div>
<script type="text/javascript">
$(document).ready(function() {

	$('#principalPasswordPolicy').localize();
		var resource = $(document).data('session').currentPrincipal;
        var el = $('#policyTab');
        el.empty();

		el.passwordPolicy({
			policy: 'principal',
			showPolicyName: false,
			showRulesDefault: false,
			principalId: resource.id,
			showGenerator: false,
			complete: function() {
				debugger;
				var el2 = $('#infoTab');
			    el2.empty();
				el2.append('<h4 localize="passwordInformation.text"></h4>')
			    el2.append('<div class="row"><label localize="password.lastChanged" class="col-xs-6"></label><span class="col-xs-6">' + new Date(resource.lastPasswordChange).format('ddd, dd mmm yyyy HH:MM') + '</span></div>');
			    el2.append('<div class="row"><label localize="password.needsChanging" class="col-xs-6"></label><span class="col-xs-6">' + (resource.passwordChangeRequired ? getResource('text.yes') : getResource('text.no'))  + '</span></div>');
			    el2.append('<div class="row"><label localize="password.changeAllowed" class="col-xs-6"></label><span class="col-xs-6">' + (resource.passwordChangeAllowed ? getResource('text.yes') : getResource('text.no'))  + '</span></div>');
			    el2.append('<div class="row"><label localize="password.expiring" class="col-xs-6"></label><span class="col-xs-6">' + (resource.passwordExpiring ? getResource('text.yes') : getResource('text.no'))  + '</span></div>');
			    if(resource.passwordExpiring) {
			    	el2.append('<div class="row"><label localize="password.expires" class="col-xs-6"></label><span class="col-xs-6">' + new Date(resource.passwordExpiry).format('ddd, dd mmm yyyy HH:MM') + '</span></div>');
			    }
			    el2.localize();
			}
		});
    });
</script>